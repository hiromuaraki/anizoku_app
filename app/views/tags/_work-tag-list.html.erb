<div class="container" id="tag-list">
  <h1 style="color: #FFF; padding: 20px;"><i class="fas fa-search"></i> 他のジャンルから探す</h1>
  <div class="row ele-left">
    <% @tags.each_with_index do |tag, i| %>
      <div style="font-size: 25px">
        <span style="background-color: #130B06; padding: 5px; line-height: 2em; font-size: 25px;">
          <%= link_to "/tags/work_list/#{tag.id}", class: "badge rounded-pill bg-secondary edit-link card-link", remote: true do%>
            <%= tag.name %>
          <% end %>
        </span>
      </div>
    <% end %>
    <div style="margin-top: 40px; margin-left: 900px;">
      <p class="edit-link right" style="font-size: 13px"><%= render partial: "shared/more-watch-modal-tags", locals: {tags: Tag.all} %></p>
    </div>
  </div>
    <p></p>
  <h1 style="color: #FFF; padding: 10px;"><i class="fas fa-tags"></i> <%= @tag.name %>(<%= @staff_works.blank? ? @works.size : @staff_works.size %>件)</h1>
    <div class="row ele-left">
      <div>
        <% if @staff_works.blank?%>
          <% @season_list_works.keys.size.times do |count| %>
            <h3 style="font-style: italic; color: #FFFFFF;"><span style="font-size: 25px" class="box-title"><%= "#{@season_list_works.keys[count]}年"%> <%= "(#{@season_list_works.values[count].size}件)" %><span></h3>
            <div class="row" style="box-shadow: 0 2px 2px rgba(0, 0, 0, 0.32); border-radius: 2px; ">
              <% @works.each_with_index do |work, i| %>
                <% if @season_list_works.keys[count] == work.season_year %>
                  <div style="margin-left: 5px">
                    <div class="parent" style="width: 140px; background-color: #E5E5E5;">
                      <p style="font-size: 15px; color: #FFF; margin: 0 auto; text-align: center; background-color: #E60914;"><%= work.season_name_text.slice(-1) %></p>
                      <div style="width: 140px; height: 70px;">
                        <%# マイリストへ追加 %>
                        <div class="mylists">
                          <%= render partial:"shared/mylists-status-2", locals: {work_id: work.id ,index: i} %>
                        </div>
                        <%= link_to "/works/detail/#{work.id}" do %>
                          <% image_tag !work&.facebook_og_image_url.blank? ? work&.facebook_og_image_url : "no_image", alt: "#{work.title}", class: "img-thumbnail img-responsive img-rounded" %>
                        <% end %>
                      </div>
                      <div class="dropdown" style="margin-top: 18px;height: 130px;">
                        <%# 視聴ステータスを配置 これをReactでコンポーネント化する%>
                        <%= form_with url: "/watches/update", method: :patch, remote: true, id: "status-update#{i}" do |f| %>
                          <%= hidden_field_tag :work_id, "work_id" %>
                          <%= hidden_field_tag :watch_status, "status" %>
                          <%=
                            f.select :val, 
                              [
                                ["見た",    "watched"],
                                ["見てる",  "watching"],
                                ["見てない","not_watched"],
                                ["見たい","want_watch"]
                              ],{include_blank: "ステータスを選択", selected: !@watches_works.blank? ? status_type(@watches_works, work.id) : "ステータスを選択"},{class: "btn btn-block btn-success  dropdown-toggle",id: "select-form-#{i}",required: true, autofocus: "true", data: {work_id: work.id }}
                          %>
                        <% end %>
                        <caption>
                          <%# 視聴ステータスを配置 これをReactでコンポーネント化する%>
                          <span style="font-size: 15px; color: #000;"><%= work.title.truncate(20) %></span>
                        </caption>
                          
                      </div>
                      
                    </div>
                    <p></p>
                  </div>
                <% end %>
              <% end %>
            </div>
            <p></p>
          <% end %>

        <% else %>

            <% @season_list_staff.keys.size.times do |count| %>
              <h3 style="font-style: italic; color: #FFFFFF;"><span style="font-size: 25px" class="box-title"><%= "#{@season_list_staff.keys[count]}年"%> <%= "(#{@season_list_staff.values[count].size}件)" %><span></h3>
              <div class="row" style="box-shadow: 0 2px 2px rgba(0, 0, 0, 0.32); border-radius: 2px; ">
                <% @staff_works.each_with_index do |work, i| %>
                  <% if @season_list_staff.keys[count] == work.season_year %>
                    <div style="margin-left: 5px">
                      <div class="parent" style="width: 140px; background-color: #E5E5E5;">
                        <p style="font-size: 15px; color: #FFF; margin: 0 auto; text-align: center; background-color: #E60914;"><%= work.season_name_text.slice(-1) %></p>
                        <div style="width: 140px; height: 70px;">
                          <%# マイリストへ追加 %>
                          <div class="mylists">
                            <%= render partial:"shared/mylists-status-2", locals: {work_id: work.id ,index: i} %>
                          </div>
                          <%= link_to "/works/detail/#{work.id}" do %>
                            <% image_tag !work&.facebook_og_image_url.blank? ? work&.facebook_og_image_url : "no_image", alt: "#{work.title}", class: "img-thumbnail img-responsive img-rounded" %>
                          <% end %>
                        </div>
                        <div class="dropdown" style="margin-top: 18px;height: 130px;">
                          <%# 視聴ステータスを配置 これをReactでコンポーネント化する%>
                          <%= form_with url: "/watches/update", method: :patch, remote: true, id: "status-update#{i}" do |f| %>
                            <%= hidden_field_tag :work_id, "work_id" %>
                            <%= hidden_field_tag :watch_status, "status" %>
                            <%=
                              f.select :val, 
                                [
                                  ["見た",    "watched"],
                                  ["見てる",  "watching"],
                                  ["見てない","not_watched"],
                                  ["見たい","want_watch"]
                                ],{include_blank: "ステータスを選択", selected: !@watches_staff.blank? ? status_type(@watches_staff, work.id) : "ステータスを選択"},{class: "btn btn-block btn-success  dropdown-toggle",id: "select-form-#{i}",required: true, autofocus: "true", data: {work_id: work.id }}
                            %>
                          <% end %>
                          <caption>
                            <%# 視聴ステータスを配置 これをReactでコンポーネント化する%>
                            <span style="font-size: 15px; color: #000;"><%= work.title.truncate(20) %></span>
                          </caption>

                        </div>

                      </div>
                      <p></p>
                    </div>
                  <% end %>
                <% end %>
              </div>
              <p></p>
            <% end %>
          
          
            <%= javascript_pack_tag 'form/select-status' %>
        <% end %>
      </div>
    </div>
  </div>
</div>